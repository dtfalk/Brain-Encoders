# ===========================================================================
#  Brain-Encoders — Local Development Environment (NVIDIA Blackwell 5070)
# ===========================================================================
#
#  Hardware target:
#    - NVIDIA GeForce RTX 5070 (Blackwell, ~12 GB VRAM)
#    - CUDA 12.8 / sm_120 (Blackwell architecture)
#
#  Usage:
#    conda env create -f environment-local.yml
#    conda activate brain-encoders
#    pip install -e ".[all]"
#
#  Notes:
#    - Uses PyTorch nightly with CUDA 12.8 for Blackwell support
#    - timm + transformers included for model-agnostic extraction
#    - opencv for video frame extraction
#    - statsmodels + pingouin for statistical tests matching MATLAB
#    - Rich logging dashboard like node reference code
# ===========================================================================

name: brain-encoders

channels:
  - conda-forge
  - defaults

dependencies:
  - python=3.11
  - pip

  # ---------- BLAS (OpenBLAS, NOT MKL — avoids OpenMP conflict with torch) ----------
  - libblas=*=*openblas*
  - libcblas=*=*openblas*
  - liblapack=*=*openblas*

  # ---------- Core Scientific Stack ----------
  - numpy>=1.26
  - scipy>=1.12
  - pandas>=2.1
  - matplotlib>=3.8
  - seaborn>=0.13

  # ---------- Neuroimaging ----------
  - nibabel>=5.2
  - nilearn>=0.10

  # ---------- Stats (MATLAB-matching) ----------
  - statsmodels>=0.14

  # ---------- Rich Terminal Dashboard ----------
  - rich>=13.0

  # ---------- Media ----------
  - ffmpeg>=6.0
  - pillow>=10.0

  # ---------- Pip-Only Packages ----------
  - pip:
    # -- PyTorch (Blackwell / CUDA 12.8 — stable, sm_120 supported since 2.7+) --
    - --extra-index-url https://download.pytorch.org/whl/cu128
    - torch>=2.10.0
    - torchvision>=0.25.0

    # -- Feature extraction (model-agnostic) --
    - timm>=1.0
    - transformers>=4.40
    - opencv-python>=4.9

    # -- Encoding pipeline core --
    - scikit-learn>=1.4
    - pyyaml>=6.0
    - typer[all]>=0.9
    - h5py>=3.10
    - pydantic>=2.5
    - jsonschema>=4.0

    # -- Stats extras --
    - pingouin>=0.5        # effect sizes, Bayesian t-tests

    # -- Dev / QA --
    - pytest>=8.0
    - pytest-cov>=4.0
    - ruff>=0.4
    - mypy>=1.8
